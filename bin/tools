#!/usr/bin/env node

const fs = require('fs')
const path = require('path')
const args = require('minimist')(process.argv.slice(2))

const env = path.join(process.cwd(), '.env')

if (fs.existsSync(env)) {
  require('dotenv').config({ path: env })
}

const tools = require('../lib')

if (tools[args._]) {
  const res = tools[args._](args)

  if (res instanceof Promise) {
    res.catch((err) => {
      console.error(err.message)
      process.exit()
    })
  }
} else {
  console.error(`No task named "${args._}"`)
  console.error(`Valid tasks are: ${Object.keys(tools)}`)
}
